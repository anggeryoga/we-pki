import{s}from"./supabase-B6KWXDKJ.js";class f{static async uploadImage(e,r="gallery"){try{if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type))throw new Error("Tipe file tidak didukung. Gunakan JPG, PNG, atau WebP.");const a=5*1024*1024;if(e.size>a)throw new Error("Ukuran file terlalu besar. Maksimal 5MB.");const o=e.name.split(".").pop(),n=`${Date.now()}-${Math.random().toString(36).substring(2)}.${o}`,c=`${r}/${n}`,{data:u,error:i}=await s.storage.from("images").upload(c,e,{cacheControl:"3600",upsert:!1});if(i)throw i;const{data:{publicUrl:m}}=s.storage.from("images").getPublicUrl(c);return{success:!0,url:m,path:c}}catch(t){return{success:!1,error:t.message}}}static async addGalleryImage(e){try{const{data:r,error:t}=await s.from("gallery_images").insert([{...e,created_at:new Date().toISOString()}]).select().single();if(t)throw t;return{success:!0,data:r}}catch(r){return{success:!1,error:r.message}}}static async getGalleryImages(){try{const{data:e,error:r}=await s.from("gallery_images").select("*").order("created_at",{ascending:!1});if(r)throw r;return{success:!0,data:e}}catch(e){return{success:!1,error:e.message}}}static async deleteGalleryImage(e){try{const{data:r}=await s.from("gallery_images").select("image_path").eq("id",e).single();r?.image_path&&await s.storage.from("images").remove([r.image_path]);const{error:t}=await s.from("gallery_images").delete().eq("id",e);if(t)throw t;return{success:!0}}catch(r){return{success:!1,error:r.message}}}static async updateGalleryImage(e,r){try{const{data:t,error:a}=await s.from("gallery_images").update(r).eq("id",e).select().single();if(a)throw a;return{success:!0,data:t}}catch(t){return{success:!1,error:t.message}}}}class d{static async submitMemberForm(e){try{const{data:r,error:t}=await s.from("member_forms").insert([{name:e.name,region:e.region,cat_info:e.cat_info,reason:e.reason,status:"pending",created_at:new Date().toISOString()}]).select().single();if(t)throw t;return{success:!0,data:r}}catch(r){return{success:!1,error:r.message}}}static async getAllMemberForms(){try{const{data:e,error:r}=await s.from("member_forms").select("*").order("created_at",{ascending:!1});if(r)throw r;return{success:!0,data:e}}catch(e){return{success:!1,error:e.message}}}static async updateMemberFormStatus(e,r){try{const{data:t,error:a}=await s.from("member_forms").update({status:r}).eq("id",e).select().single();if(a)throw a;return{success:!0,data:t}}catch(t){return{success:!1,error:t.message}}}static async deleteMemberForm(e){try{const{error:r}=await s.from("member_forms").delete().eq("id",e);if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r.message}}}static async getMemberStats(){try{const{data:e,error:r}=await s.from("member_forms").select("status");if(r)throw r;const t=e.length,a=e.filter(c=>c.status==="pending").length,o=e.filter(c=>c.status==="approved").length,n=e.filter(c=>c.status==="rejected").length;return{success:!0,stats:{total:t,pending:a,approved:o,rejected:n}}}catch(e){return{success:!1,error:e.message}}}}export{f as G,d as M};
