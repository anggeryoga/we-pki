import{s as o}from"./supabase-C7oNB1te.js";class c{static async login(r,t){try{const{data:e,error:s}=await o.auth.signInWithPassword({email:r,password:t});if(s)throw s;return{success:!0,user:e.user}}catch(e){return{success:!1,error:e.message}}}static async logout(){try{const{error:r}=await o.auth.signOut();if(r)throw r;return{success:!0}}catch(r){return{success:!1,error:r.message}}}static async getCurrentUser(){try{const{data:{session:r},error:t}=await o.auth.getSession();if(t||!r)throw new Error("No active session found");const{data:{user:e},error:s}=await o.auth.getUser();if(s)throw s;return e}catch(r){return console.error("Error getting current user:",r),null}}static async checkAdminRole(r){try{const{data:t,error:e}=await o.from("admin_users").select("role").eq("user_id",r).single();if(e)throw e;return t?.role==="admin"}catch(t){return console.error("Error checking admin role:",t),!1}}static redirectToLogin(){window.location.href="/login.html"}static redirectToDashboard(){window.location.href="/admin.html"}}export{c as A};
